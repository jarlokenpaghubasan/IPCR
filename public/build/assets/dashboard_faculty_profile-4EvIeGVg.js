window.toggleMobileMenu=function(){const e=document.querySelector(".mobile-menu"),t=document.querySelector(".mobile-menu-overlay");e.classList.toggle("active"),t.classList.toggle("active")};window.toggleNotificationPopup=function(){document.getElementById("notificationPopup").classList.toggle("active")};window.toggleNotificationPopupMobile=function(){document.getElementById("notificationPopupMobile").classList.toggle("active")};document.addEventListener("click",function(e){const t=document.getElementById("notificationPopup"),o=document.getElementById("notificationPopupMobile");e.target.closest('button[onclick*="toggleNotificationPopup"]')||(t&&!t.contains(e.target)&&t.classList.remove("active"),o&&!o.contains(e.target)&&o.classList.remove("active"))});window.togglePasswordVisibility=function(e){const t=document.getElementById(e),o=document.getElementById(e+"_eye_open"),s=document.getElementById(e+"_eye_closed");t.type==="password"?(t.type="text",o.classList.add("hidden"),s.classList.remove("hidden")):(t.type="password",o.classList.remove("hidden"),s.classList.add("hidden"))};window.openChangePasswordModal=function(){document.getElementById("changePasswordModal").classList.remove("hidden"),document.getElementById("changePasswordForm").reset(),["current_password","new_password","new_password_confirmation"].forEach(e=>{const t=document.getElementById(e),o=document.getElementById(e+"_eye_open"),s=document.getElementById(e+"_eye_closed");t.type="password",o.classList.remove("hidden"),s.classList.add("hidden")}),document.getElementById("passwordMessage").classList.add("hidden"),["current_password_error","new_password_error","new_password_confirmation_error"].forEach(e=>{document.getElementById(e).classList.add("hidden"),document.getElementById(e).textContent=""})};window.closeChangePasswordModal=function(){document.getElementById("changePasswordModal").classList.add("hidden")};document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("changePasswordModal");e&&e.addEventListener("click",function(o){o.target===this&&window.closeChangePasswordModal()});const t=document.getElementById("changePasswordForm");t&&t.addEventListener("submit",async function(o){o.preventDefault();const s=new FormData(this),n=document.getElementById("passwordMessage");["current_password_error","new_password_error","new_password_confirmation_error"].forEach(d=>{document.getElementById(d).classList.add("hidden"),document.getElementById(d).textContent=""});try{const d=await fetch(this.action,{method:"POST",body:s,headers:{"X-Requested-With":"XMLHttpRequest"}}),r=await d.json();d.ok?(n.className="rounded-lg p-3 text-sm bg-green-50 text-green-800 border border-green-200",n.textContent=r.message||"Password updated successfully!",n.classList.remove("hidden"),setTimeout(()=>{window.closeChangePasswordModal(),this.reset()},2e3)):r.errors?Object.keys(r.errors).forEach(c=>{const a=document.getElementById(c+"_error");a&&(a.textContent=r.errors[c][0],a.classList.remove("hidden"))}):(n.className="rounded-lg p-3 text-sm bg-red-50 text-red-800 border border-red-200",n.textContent=r.message||"An error occurred. Please try again.",n.classList.remove("hidden"))}catch{n.className="rounded-lg p-3 text-sm bg-red-50 text-red-800 border border-red-200",n.textContent="An error occurred. Please try again.",n.classList.remove("hidden")}})});document.addEventListener("keydown",function(e){e.key==="Escape"&&window.closeChangePasswordModal()});
